{% extends "layout.html" %}
{% load static humanize %}
{% block title %}Ma voiture de location{% endblock %}
{% block content %}
<!-- Page content -->
<main class="content-wrapper" style="max-width: 1920px; background-color: #f8f9fa;">
      <div class="container pt-4 pt-sm-5 pb-5 mb-xxl-3">
        <div class="row pt-2 pt-sm-0 pt-lg-2 pb-2 pb-sm-3 pb-md-4 pb-lg-5">

          <!-- Sidebar navigation that turns into offcanvas on screens < 992px wide (lg breakpoint) -->
            {% include "partials/sidebar-account.html" %}

          <!-- Account listings content -->
          <div class="col-lg-9">
            <section class="pb-5 mb-md-3">
              <div class="d-flex align-items-center justify-content-between pb-1 pb-sm-0 mb-3 mb-sm-4">
                <h2 class="h2 mb-0 me-3">Mes annonces</h2>
                <div class="nav">
                  <a class="nav-link position-relative px-0" href="{% url 'car_create' %}">
                    <i class="fi-plus fs base me-2"></i>
                    <span class="hover-effect-underline stretched-link me-1">Louer ma voiture</span>
                    <i class="fi-chevron-right fs-base"></i>
                  </a>
                </div>
              </div>
              <div class="vstack gap-3">
                {% if last_cars %}
  {% for car in last_cars %}
    <article class="card">
      <div class="row g-0">
        <div class="col-sm-4 col-md-3 rounded overflow-hidden pb-2 pb-sm-0 pe-sm-2">
          <a class="position-relative d-flex h-100 bg-body-tertiary"
             href="{{ car.get_absolute_url }}"
             style="min-height: 174px">
            {% with cover=car.cover_photo %}
              {% if cover and cover.image %}
                <img src="{{ cover.image.url }}"
                     class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
                     alt="{{ car.title }}">
              {% else %}
                <img src="{% static 'assets/img/placeholders/car-16x9.jpg' %}"
                     class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
                     alt="{{ car.title }}">
              {% endif %}
            {% endwith %}
            <div class="ratio d-none d-sm-block" style="--fn-aspect-ratio: calc(180 / 240 * 100%)"></div>
            <div class="ratio ratio-16x9 d-sm-none"></div>
          </a>
        </div>

        <div class="col-sm-8 col-md-9 align-self-center">
          <div class="card-body d-flex justify-content-between p-3 py-sm-4 ps-sm-2 ps-md-3 pe-md-4 mt-n1 mt-sm-0">

            <div class="position-relative pe-3">
              <span class="badge text-body-emphasis bg-body-secondary mb-2">
                {% if car.is_active %}Publiée{% else %}Brouillon{% endif %}
              </span>

              <div class="h5 mb-2">{{ car.daily_price|intcomma }} F / jour</div>

              <a class="stretched-link d-block fs-sm text-body text-decoration-none mb-2"
                 href="{{ car.get_absolute_url }}">
                {{ car.title }}
              </a>

              <div class="h6 fs-sm mb-0">
                {{ car.place.city.name }} • {{ car.year }}
              </div>
            </div>

            <div class="text-end">
              <div class="fs-xs text-body-secondary mb-3">
                Créée : {{ car.created_at|date:"d/m/Y" }}
              </div>
              <div class="d-flex justify-content-end gap-2 mb-3">
                <a href="{{ car.get_absolute_url }}" class="btn btn-outline-secondary">Voir</a>
                <a href="{{ car.get_absolute_url_update }}" class="btn btn-outline-warning">Modifier</a>
                <a href="{{ car.get_absolute_url_delete }}" class="btn btn-outline-danger">Supprimer</a>
              </div>
            </div>

          </div>
        </div>
      </div>
    </article>
  {% endfor %}
{% else %}
  <p class="text-body-secondary">Aucune annonce pour le moment.</p>
{% endif %}


              </div>
            </section>
          </div>
        </div>
      </div>
    </main>

{% endblock %}