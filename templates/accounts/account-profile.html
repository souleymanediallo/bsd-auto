{% extends "layout.html" %}
{% load static humanize %}
{% block title %}Ma voiture de location{% endblock %}
{% block content %}

    <!-- Page content -->
    <main class="content-wrapper">
      <div class="container pt-4 pt-sm-5 pb-5 mb-xxl-3">
        <div class="row pt-2 pt-sm-0 pt-lg-2 pb-2 pb-sm-3 pb-md-4 pb-lg-5">


          <!-- Sidebar navigation that turns into offcanvas on screens < 992px wide (lg breakpoint) -->
            {% include "partials/sidebar-account.html" %}

          <!-- Account profile content -->
          <div class="col-lg-9">
            <h1 class="h2 pb-2 pb-lg-3">Mon compte</h1>
            <!-- Wallet + Account progress -->
            <section class="row g-3 g-xl-4 pb-5 mb-md-3">
              <div class="col-md-6 col-lg-5 col-xl-6">
                <div class="card bg-success-subtle border-0 h-100">
                  <div class="card-body">
                    <h3 class="fs-sm fw-normal mb-2">Louer ma voiture</h3>
                    <div class="h5 mb-0">

                    </div>
                  </div>
                  <div class="card-footer bg-transparent border-0 pt-0 pb-4 mt-n2 mt-sm-0">
                    <a class="position-relative d-inline-flex align-items-center fs-sm fw-medium text-success text-decoration-none" href="#!">
                      <span class="hover-effect-underline stretched-link">Gagner de l'argent en louant votre voiture</span>
                      <i class="fi-chevron-right fs-base ms-1"></i>
                    </a>
                  </div>
                </div>
              </div>
              <div class="col-md-6 col-lg-7 col-xl-6">
                <div class="card bg-warning-subtle border-0 h-100">
                  <div class="card-body d-flex align-items-center">
                    <div class="ps-3 ps-sm-4">
                      <h3 class="h6 pb-1 mb-2">Critères essentiels</h3>
                      <ul class="list-unstyled fs-sm mb-0">
                        <li class="d-flex">
                          <i class="fi-plus fs-base me-2" style="margin-top: .1875rem"></i>
                          Véhicule conforme et en bon état
                        </li>
                        <li class="d-flex">
                          <i class="fi-plus fs-base me-2" style="margin-top: .1875rem"></i>
                          Annonce claire et complète
                        </li>
                        <li class="d-flex">
                          <i class="fi-plus fs-base me-2" style="margin-top: .1875rem"></i>
                          Confiance et sécurité
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </section>


            <!-- User info -->
            <section class="pb-5 mb-md-3">
              <div class="ratio ratio-1x1 bg-body-tertiary border rounded-circle overflow-hidden mb-3 mb-md-4" style="width: 124px">
                <img src="{{ user.profile.image.url }}" alt="Avatar">
              </div>
              <h2 class="h5 pb-1 pb-sm-0 mb-2 mb-sm-3">{{ user.first_name }} {{ user.last_name }}</h2>
              <ul class="list-unstyled flex-row flex-wrap gap-sm-3 fs-sm mb-3">
                <li class="d-flex align-items-center me-2">
                  <i class="fi-mail fs-base me-2"></i>
                  {{ user.email }}
                </li>
                <li class="d-flex align-items-center me-2">
                  <i class="fi-phone fs-base me-2"></i>
                  {{ user.phone_number|default:"Not provided" }}
                </li>
              </ul>
              <p class="fs-sm pb-sm-1 pb-md-0 mb-md-4">
                <i class="fi-info-circle text-body-secondary me-2"></i>
                {{ user.profile.description|default:"Mettre à jour votre présentation" }}
              </p>
              <a class="btn btn-outline-secondary" href="#">Modifier mes informations</a>
            </section>


            <!-- User listings -->
            <section class="pb-5 mb-md-3">
              <div class="d-flex align-items-center justify-content-between pb-1 pb-sm-0 mb-3 mb-sm-4">
                <h2 class="h4 mb-0 me-3">Mes annonces</h2>
                <div class="nav">
                  <a class="nav-link position-relative px-0" href="{% url 'car_create' %}">
                    <i class="fi-plus fs base me-2"></i>
                    <span class="hover-effect-underline stretched-link me-1">Louer ma voiture</span>
                    <i class="fi-chevron-right fs-base"></i>
                  </a>
                </div>
              </div>
              <div class="vstack gap-3">
                {% if last_cars %}
  {% for car in last_cars %}
    <article class="card">
      <div class="row g-0">
        <div class="col-sm-4 col-md-3 rounded overflow-hidden pb-2 pb-sm-0 pe-sm-2">
          <a class="position-relative d-flex h-100 bg-body-tertiary"
             href="{{ car.get_absolute_url }}"
             style="min-height: 174px">
            {% with cover=car.cover_photo %}
              {% if cover and cover.image %}
                <img src="{{ cover.image.url }}"
                     class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
                     alt="{{ car.title }}">
              {% else %}
                <img src="{% static 'assets/img/placeholders/car-16x9.jpg' %}"
                     class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
                     alt="{{ car.title }}">
              {% endif %}
            {% endwith %}
            <div class="ratio d-none d-sm-block" style="--fn-aspect-ratio: calc(180 / 240 * 100%)"></div>
            <div class="ratio ratio-16x9 d-sm-none"></div>
          </a>
        </div>

        <div class="col-sm-8 col-md-9 align-self-center">
          <div class="card-body d-flex justify-content-between p-3 py-sm-4 ps-sm-2 ps-md-3 pe-md-4 mt-n1 mt-sm-0">

            <div class="position-relative pe-3">
              <span class="badge text-body-emphasis bg-body-secondary mb-2">
                {% if car.is_active %}Publiée{% else %}Brouillon{% endif %}
              </span>

              <div class="h5 mb-2">{{ car.daily_price|intcomma }} F / jour</div>

              <a class="stretched-link d-block fs-sm text-body text-decoration-none mb-2"
                 href="{{ car.get_absolute_url }}">
                {{ car.title }}
              </a>

              <div class="h6 fs-sm mb-0">
                {{ car.place.city.name }} • {{ car.year }}
              </div>
            </div>

            <div class="text-end">
              <div class="fs-xs text-body-secondary mb-3">
                Créée : {{ car.created_at|date:"d/m/Y" }}
              </div>
              <div class="d-flex justify-content-end gap-2 mb-3">
                <a href="{{ car.get_absolute_url }}" class="btn btn-outline-secondary">Voir</a>
                <a href="{{ car.get_absolute_url_update }}" class="btn btn-outline-warning">Modifier</a>
                <a href="{{ car.get_absolute_url_delete }}" class="btn btn-outline-danger">Supprimer</a>
              </div>
            </div>

          </div>
        </div>
      </div>
    </article>
  {% endfor %}
{% else %}
  <p class="text-body-secondary">Aucune annonce pour le moment.</p>
{% endif %}


              </div>
            </section>
            <!-- Help center -->
            <section>
              <h2 class="h4 mb-4">Besoin d'aide ?</h2>
              <div class="row row-cols-1 row-cols-sm-2 g-4 g-md-5">
                <div class="col">
                  <div class="position-relative">
                    <i class="fi-globe fs-4 text-dark-emphasis pb-1 pb-md-0 mb-2 mb-md-3"></i>
                    <h3 class="h6 pb-md-1 mb-2">
                      <a class="hover-effect-underline stretched-link" href="#!">Suivre nos actualités</a>
                    </h3>
                    <p class="fs-sm mb-0">
                        BSD AUTO est une plateforme de location de voitures entre particuliers.
                        Nous vous proposons des voitures à louer pour vos déplacements quotidiens ou vos voyages.
                        Notre objectif est de rendre la location de voiture simple, rapide et accessible à tous.
                    </p>
                  </div>
                </div>
                <div class="col">
                  <div class="position-relative">
                    <i class="fi-headphones fs-4 text-dark-emphasis pb-1 pb-md-0 mb-2 mb-md-3"></i>
                    <h3 class="h6 pb-md-1 mb-2">
                      <a class="hover-effect-underline stretched-link" href="#!">
                        Service client
                      </a>
                    </h3>
                    <p class="fs-sm mb-0">
                        Notre équipe est à votre disposition pour répondre à toutes vos questions.
                        Vous pouvez nous contacter par email ou par téléphone.
                        Nous sommes là pour vous aider et vous accompagner dans vos démarches.
                    </p>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>
      </div>
    </main>

{% endblock %}
